<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OraCLI — Deep Analysis Report | Q1 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:#06060a;--s1:#0e0e16;--s2:#16161f;--s3:#1e1e2a;
    --bd:#252535;--bdl:#35354a;
    --t:#eaeaf0;--td:#7a7a9a;--tm:#55556a;
    --ac:#7c6cf0;--ac2:#a8a0ff;
    --g:#34d399;--gb:rgba(52,211,153,.08);--gbd:rgba(52,211,153,.2);
    --r:#f87171;--rb:rgba(248,113,113,.08);
    --y:#fbbf24;--yb:rgba(251,191,36,.08);
    --b:#60a5fa;--bb:rgba(96,165,250,.08);
    --cy:#22d3ee;--p:#a78bfa;
    --gr:linear-gradient(135deg,#7c6cf0,#a78bfa,#c4b5fd);
    --gg:linear-gradient(135deg,#059669,#34d399);
  }
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Inter',-apple-system,system-ui,sans-serif;background:var(--bg);color:var(--t);line-height:1.7;-webkit-font-smoothing:antialiased}
  code,.mono{font-family:'JetBrains Mono',monospace;font-size:.85em}
  .wrap{max-width:1080px;margin:0 auto;padding:0 2rem}
  a{color:var(--ac2);text-decoration:none}

  /* Typography */
  .hero{padding:5rem 2rem 2rem;text-align:center;position:relative}
  .hero::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:900px;height:600px;background:radial-gradient(ellipse,rgba(124,108,240,.05)0%,transparent 70%);pointer-events:none}
  .badge{display:inline-flex;align-items:center;gap:.4rem;background:var(--s2);border:1px solid var(--bd);padding:.35rem 1rem;border-radius:100px;font-size:.7rem;font-weight:600;color:var(--ac2);letter-spacing:.08em;text-transform:uppercase;margin-bottom:1.5rem}
  .badge .dot{width:6px;height:6px;border-radius:50%;background:var(--g);animation:p 2s infinite}
  @keyframes p{0%,100%{opacity:1}50%{opacity:.3}}
  .hero h1{font-size:2.6rem;font-weight:900;letter-spacing:-.03em;background:var(--gr);-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1.1;margin-bottom:.6rem}
  .hero .sub{color:var(--td);font-size:1rem}
  .hero .meta{color:var(--tm);font-size:.8rem;margin-top:.6rem}

  h2{font-size:1.3rem;font-weight:800;letter-spacing:-.02em;margin:3rem 0 .3rem;color:var(--t)}
  h3{font-size:1rem;font-weight:700;margin:2rem 0 .5rem;color:var(--t)}
  .chapter{margin:4rem 0;padding-top:2rem;border-top:1px solid var(--bd)}
  .chapter-num{font-size:.7rem;font-weight:700;color:var(--ac);text-transform:uppercase;letter-spacing:.12em;margin-bottom:.3rem}
  p{color:var(--td);font-size:.88rem;margin:.6rem 0;max-width:75ch}
  .highlight{color:var(--t);font-weight:600}
  .callout{background:var(--s1);border-left:3px solid var(--ac);padding:1rem 1.2rem;border-radius:0 8px 8px 0;margin:1.5rem 0;font-size:.85rem}
  .callout.green{border-color:var(--g)}
  .callout.yellow{border-color:var(--y)}

  /* Stat Grid */
  .sg{display:grid;gap:1px;background:var(--bd);border:1px solid var(--bd);border-radius:14px;overflow:hidden;margin:1.5rem 0}
  .sg-4{grid-template-columns:repeat(4,1fr)}
  .sg-3{grid-template-columns:repeat(3,1fr)}
  .sg-2{grid-template-columns:repeat(2,1fr)}
  .sc{background:var(--s1);padding:1.5rem 1.2rem;text-align:center}
  .sc .l{font-size:.65rem;text-transform:uppercase;letter-spacing:.1em;color:var(--tm);font-weight:600;margin-bottom:.4rem}
  .sc .n{font-size:2rem;font-weight:800;letter-spacing:-.02em}
  .sc .d{font-size:.72rem;color:var(--td);margin-top:.3rem}

  /* Cards */
  .card{background:var(--s1);border:1px solid var(--bd);border-radius:12px;padding:1.5rem;margin:1rem 0}
  
  /* Tables */
  table{width:100%;border-collapse:collapse;font-size:.83rem;margin:.5rem 0}
  th{text-align:left;font-weight:600;font-size:.67rem;text-transform:uppercase;letter-spacing:.08em;color:var(--tm);padding:.55rem .7rem;border-bottom:1px solid var(--bd)}
  td{padding:.55rem .7rem;border-bottom:1px solid rgba(37,37,53,.4);vertical-align:top}
  tr:last-child td{border-bottom:none}
  .tag{display:inline-flex;font-size:.67rem;font-weight:600;padding:.12rem .45rem;border-radius:4px}
  .tg{background:var(--gb);color:var(--g)}.ty{background:var(--yb);color:var(--y)}.tr{background:var(--rb);color:var(--r)}.tb{background:var(--bb);color:var(--b)}

  /* Bars */
  .bar-wrap{margin:1rem 0}
  .bar-label{display:flex;justify-content:space-between;font-size:.72rem;color:var(--td);margin-bottom:.3rem}
  .bar{background:var(--s2);border-radius:8px;height:32px;overflow:hidden;position:relative}
  .bar-fill{height:100%;border-radius:8px;display:flex;align-items:center;padding:0 .8rem;font-size:.72rem;font-weight:700;min-width:60px}
  .bar-thin{height:6px;border-radius:3px;margin:.3rem 0}

  /* Compare */
  .cmp{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin:1rem 0}
  .cmp-card{background:var(--s1);border:1px solid var(--bd);border-radius:12px;overflow:hidden}
  .cmp-head{padding:.8rem 1.2rem;border-bottom:1px solid var(--bd);display:flex;justify-content:space-between;align-items:center}
  .cmp-head h4{font-size:.9rem;font-weight:700}
  .cmp-body{padding:1rem 1.2rem}
  .mr{display:flex;justify-content:space-between;align-items:baseline;padding:.4rem 0;border-bottom:1px solid rgba(37,37,53,.25)}
  .mr:last-child{border-bottom:none}
  .ml{font-size:.78rem;color:var(--td)}
  .mv{font-size:.82rem;font-weight:700;font-family:'JetBrains Mono',monospace}

  /* Scenarios */
  .scen{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin:1rem 0}
  .scen-c{background:var(--s1);border:1px solid var(--bd);border-radius:12px;padding:1.2rem;text-align:center}
  .scen-c.act{border-color:var(--ac);box-shadow:0 0 20px rgba(124,108,240,.08)}
  .scen-l{font-size:.65rem;text-transform:uppercase;letter-spacing:.08em;color:var(--tm);font-weight:600}
  .scen-n{font-size:1.6rem;font-weight:800;margin:.3rem 0}
  .scen-d{font-size:.7rem;color:var(--td);line-height:1.4}

  /* Timeline */
  .tl{position:relative;padding-left:1.8rem;margin:1rem 0}
  .tl::before{content:'';position:absolute;left:5px;top:0;bottom:0;width:2px;background:var(--bd)}
  .tl-i{position:relative;padding:.6rem 0}
  .tl-i::before{content:'';position:absolute;left:-1.8rem;top:.85rem;width:8px;height:8px;border-radius:50%;background:var(--g);border:2px solid var(--g)}
  .tl-t{font-size:.67rem;color:var(--tm);font-family:'JetBrains Mono',monospace}
  .tl-x{font-size:.82rem;margin-top:.1rem}
  .tl-d{font-size:.72rem;color:var(--td)}

  /* Donut via conic-gradient */
  .donut{width:120px;height:120px;border-radius:50%;position:relative;margin:0 auto}
  .donut::after{content:'';position:absolute;top:25%;left:25%;width:50%;height:50%;border-radius:50%;background:var(--s1)}
  .donut-label{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;text-align:center}
  .donut-label .v{font-size:1.2rem;font-weight:800}
  .donut-label .l{font-size:.6rem;color:var(--tm);text-transform:uppercase}

  /* Progress */
  .prog{background:var(--s2);border-radius:8px;height:24px;overflow:hidden;margin:.8rem 0}
  .prog-fill{height:100%;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.7rem;font-weight:700;color:var(--bg)}

  .footer{text-align:center;padding:3rem 2rem;border-top:1px solid var(--bd);margin-top:4rem;color:var(--tm);font-size:.78rem}

  @media(max-width:768px){
    .sg-4,.scen{grid-template-columns:repeat(2,1fr)}
    .cmp{grid-template-columns:1fr}
    .hero h1{font-size:1.8rem}
  }
</style>
</head>
<body>

<div class="hero">
  <div class="badge"><span class="dot"></span> Deep Analysis</div>
  <h1>OraCLI Performance Report</h1>
  <div class="sub">Multi-Agent AI System — Sprint 2 & 3 Combined Analysis</div>
  <div class="meta">revenue-OS • Q1 Core Financeiro • 23–26 Fevereiro 2026</div>
</div>

<div class="wrap">

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 0: EXECUTIVE SUMMARY -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter" style="border-top:none;padding-top:0">
  <div class="chapter-num">Sumário Executivo</div>
  <h2>2.6 horas de AI. 310 horas de trabalho humano.</h2>
  
  <p>Em quatro dias (23–26 de fevereiro de 2026), o sistema OraCLI executou duas sprints completas do projeto revenue-OS — um SaaS de gestão financeira construído sobre Stripe Connect, Supabase e Next.js. O sistema operou com <span class="highlight">custo operacional total de $64.60</span>, gerando valor equivalente a <span class="highlight">$15.533</span> em trabalho de desenvolvimento (cenário base: dev pleno, $50/h).</p>

  <p>A <span class="highlight">Sprint 2</span> focou em remediação: CI/CD quebrado, testes faltando, documentação ausente. Em 93 minutos, o sistema corrigiu root causes em 3 workflows, criou 10 suítes de teste, retroalimentou 22 tickets Jira e documentou 4 EPICs no Confluence.</p>

  <p>A <span class="highlight">Sprint 3</span> focou em entrega de features: 12 Edge Functions de produção para Subscriptions e Checkout, cobrindo o ciclo de vida completo de assinaturas (criação, cancelamento, pausa, upgrade/downgrade, webhooks, trial, billing, dashboard). Executada em 65 minutos com custo de $4.22.</p>

  <div class="sg sg-4">
    <div class="sc"><div class="l">Tempo AI Total</div><div class="n" style="color:var(--ac2)">158 min</div><div class="d">2.6 horas</div></div>
    <div class="sc"><div class="l">Equivalente Humano</div><div class="n" style="color:var(--g)">310.7h</div><div class="d">38.8 dias úteis</div></div>
    <div class="sc"><div class="l">Multiplicador</div><div class="n" style="color:var(--g)">118×</div><div class="d">mais rápido</div></div>
    <div class="sc"><div class="l">Custo Total</div><div class="n" style="color:var(--y)">$64.60</div><div class="d">somente Google API</div></div>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 1: CONTEXT -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 1</div>
  <h2>Contexto e Escopo</h2>

  <h3>1.1 O Produto: revenue-OS</h3>
  <p>Plataforma SaaS de gestão financeira e billing para empresas que operam marketplaces e modelos de assinatura. Construída sobre:</p>
  <div class="sg sg-4">
    <div class="sc"><div class="l">Edge Functions</div><div class="n" style="color:var(--b)">390</div><div class="d">Supabase / Deno</div></div>
    <div class="sc"><div class="l">Frontend Pages</div><div class="n" style="color:var(--b)">227</div><div class="d">React / Next.js</div></div>
    <div class="sc"><div class="l">Components</div><div class="n" style="color:var(--b)">181</div><div class="d">TypeScript</div></div>
    <div class="sc"><div class="l">Repo Size</div><div class="n" style="color:var(--b)">35 MB</div><div class="d">63 migrations</div></div>
  </div>

  <h3>1.2 O Sistema: OraCLI</h3>
  <p>Sistema multi-agente de IA para engenharia de software, composto por um orquestrador principal (OraCLI) e 4 subagentes especializados, operando sobre a plataforma OpenClaw.</p>
  <div class="card">
    <table>
      <thead><tr><th>Agente</th><th>Modelo</th><th>Custo Inference</th><th>Papel</th></tr></thead>
      <tbody>
        <tr><td><strong>OraCLI</strong> (main)</td><td><code>Claude Opus 4.6</code></td><td style="color:var(--g)">$0 (Antigravity)</td><td>Orquestração, arquitetura, análise, contexto</td></tr>
        <tr><td><strong>Code Agent</strong></td><td><code>Gemini 3 Flash</code></td><td style="color:var(--g)">$0 (Antigravity)</td><td>Implementação, specs, testes, code review</td></tr>
        <tr><td><strong>General Agent</strong></td><td><code>Gemini 3 Flash</code></td><td style="color:var(--g)">$0 (Antigravity)</td><td>Research, Jira, Slack, triage</td></tr>
        <tr><td><strong>Docs Agent</strong></td><td><code>Gemini 3 Flash</code></td><td style="color:var(--g)">$0 (Antigravity)</td><td>Confluence, Quarto, knowledge</td></tr>
        <tr><td><strong>Infra Agent</strong></td><td><code>Gemini 3 Flash</code></td><td style="color:var(--g)">$0 (Antigravity)</td><td>Deploy, Docker, CI/CD, monitoring</td></tr>
      </tbody>
    </table>
  </div>
  <div class="callout green">
    <strong>Decisão crítica:</strong> A migração para Antigravity (Claude/Gemini via subscription flat) eliminou o custo de inference ($0 por chamada). O custo residual de $64.60 vem exclusivamente de chamadas ao Google AI Studio API (streamer, ROI calculator, ferramentas auxiliares).
  </div>

  <h3>1.3 Q1 Core Financeiro — Os 9 EPICs</h3>
  <p>O Q1 consiste em 9 EPICs que compõem o core financeiro do revenue-OS, com um total estimado de ~280 Story Points.</p>
  <div class="card">
    <div class="prog">
      <div class="prog-fill" style="width:78%;background:var(--gg)">78% — 7/9 EPICs Concluídos</div>
    </div>
    <table>
      <thead><tr><th>EPIC</th><th>Nome</th><th>SP</th><th>Sprint</th><th>Status</th></tr></thead>
      <tbody>
        <tr><td><code>01</code></td><td>Stripe Connect Platform</td><td>34</td><td>1+2</td><td><span class="tag tg">Concluído</span></td></tr>
        <tr><td><code>02</code></td><td>Plans & Products</td><td>21</td><td>2</td><td><span class="tag tg">Concluído</span></td></tr>
        <tr style="background:var(--gb)"><td><code>03</code></td><td><strong>Subscriptions Engine</strong></td><td>55</td><td>3</td><td><span class="tag tg">Sprint 3</span></td></tr>
        <tr><td><code>04</code></td><td>Invoicing Engine</td><td>40</td><td>4</td><td><span class="tag ty">Backlog</span></td></tr>
        <tr><td><code>05</code></td><td>Payments Processing</td><td>34</td><td>2</td><td><span class="tag tg">Concluído</span></td></tr>
        <tr style="background:var(--gb)"><td><code>06</code></td><td><strong>Checkout Sessions</strong></td><td>21</td><td>3</td><td><span class="tag tg">Sprint 3</span></td></tr>
        <tr><td><code>07</code></td><td>Payouts & Transfers</td><td>21</td><td>2</td><td><span class="tag tg">Concluído</span></td></tr>
        <tr><td><code>09</code></td><td>Core Metrics Engine</td><td>—</td><td>4</td><td><span class="tag ty">Backlog</span></td></tr>
        <tr><td><code>10</code></td><td>Split Payments</td><td>34</td><td>2</td><td><span class="tag tg">Concluído</span></td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 2: TIME ANALYSIS -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 2</div>
  <h2>Análise de Tempo: AI vs Humano</h2>

  <p>A comparação central deste relatório. Quanto tempo o sistema AI levou versus quanto tempo um desenvolvedor humano levaria para produzir o mesmo output.</p>

  <h3>2.1 Sprint 2 — Remediação</h3>
  <div class="bar-wrap">
    <div class="bar-label"><span>AI: 93 minutos</span><span style="color:var(--g)">Humano: 6.864 minutos (114.4h)</span></div>
    <div class="bar"><div class="bar-fill" style="width:100%;background:rgba(96,165,250,.1);color:var(--td);justify-content:flex-end;font-size:.7rem">114.4 horas humanas</div></div>
    <div class="bar" style="margin-top:3px"><div class="bar-fill" style="width:1.35%;background:var(--ac);color:#fff;min-width:70px">93 min</div></div>
  </div>
  <p>O trabalho de remediação incluiu: diagnóstico de CI/CD quebrado (3 root causes), criação de 10 suítes de teste para Edge Functions existentes, retroalimentação de 22 tickets Jira com descrição + AC + links, criação/atualização de 4 páginas Confluence, link de 20 PRs, e assignação de 22 tickets. Um desenvolvedor sênior levaria <span class="highlight">~2.5 semanas</span> para completar este escopo com a mesma qualidade de documentação.</p>

  <h3>2.2 Sprint 3 — Feature Delivery</h3>
  <div class="bar-wrap">
    <div class="bar-label"><span>AI: 65 minutos</span><span style="color:var(--g)">Humano: 11.778 minutos (196.3h)</span></div>
    <div class="bar"><div class="bar-fill" style="width:100%;background:rgba(52,211,153,.08);color:var(--td);justify-content:flex-end;font-size:.7rem">196.3 horas humanas</div></div>
    <div class="bar" style="margin-top:3px"><div class="bar-fill" style="width:.55%;background:var(--g);color:#fff;min-width:70px">65 min</div></div>
  </div>
  <p>Feature delivery pura: 12 Edge Functions de produção (82.3 KB de código), 1 migration com 4 tabelas + indexes + RLS, 6 suítes de teste, gap analysis contra especificação Confluence. Um time de 2 desenvolvedores sêniores levaria <span class="highlight">~2.5 semanas</span> para implementar, testar e documentar este escopo.</p>

  <h3>2.3 Análise Comparativa</h3>
  <div class="cmp">
    <div class="cmp-card">
      <div class="cmp-head"><h4>Sprint 2</h4><span class="tag tg">Remediação</span></div>
      <div class="cmp-body">
        <div class="mr"><span class="ml">Execução AI</span><span class="mv">93 min</span></div>
        <div class="mr"><span class="ml">Equivalente humano</span><span class="mv" style="color:var(--g)">114.4h</span></div>
        <div class="mr"><span class="ml">Multiplicador</span><span class="mv">74×</span></div>
        <div class="mr"><span class="ml">Custo/min AI</span><span class="mv" style="color:var(--y)">$0.65</span></div>
        <div class="mr"><span class="ml">Custo/hora humana equiv.</span><span class="mv">$0.53</span></div>
        <div class="mr"><span class="ml">Traces</span><span class="mv">1,815</span></div>
        <div class="mr"><span class="ml">Agentes ativos</span><span class="mv">5</span></div>
        <div class="mr"><span class="ml">Modelo principal</span><span class="mv" style="font-size:.72rem">Gemini Flash</span></div>
      </div>
    </div>
    <div class="cmp-card" style="border-color:var(--gbd)">
      <div class="cmp-head" style="background:var(--gb)"><h4>Sprint 3</h4><span class="tag tg">Features</span></div>
      <div class="cmp-body">
        <div class="mr"><span class="ml">Execução AI</span><span class="mv" style="color:var(--g)">65 min</span></div>
        <div class="mr"><span class="ml">Equivalente humano</span><span class="mv" style="color:var(--g)">196.3h</span></div>
        <div class="mr"><span class="ml">Multiplicador</span><span class="mv" style="color:var(--g)">181×</span></div>
        <div class="mr"><span class="ml">Custo/min AI</span><span class="mv" style="color:var(--g)">$0.06</span></div>
        <div class="mr"><span class="ml">Custo/hora humana equiv.</span><span class="mv" style="color:var(--g)">$0.02</span></div>
        <div class="mr"><span class="ml">Traces</span><span class="mv">299</span></div>
        <div class="mr"><span class="ml">Agentes ativos</span><span class="mv">2</span></div>
        <div class="mr"><span class="ml">Modelo principal</span><span class="mv" style="font-size:.72rem;color:var(--g)">Claude Opus ($0)</span></div>
      </div>
    </div>
  </div>

  <div class="callout">
    <strong>Insight:</strong> Sprint 3 produziu 72% mais valor humano-equivalente em 30% menos tempo e 93% menos custo. A diferença principal: migração de modelo pago (Gemini Flash) para subscription flat (Claude Opus via Antigravity), e evolução do batch pattern de execução.
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 3: COST ECONOMICS -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 3</div>
  <h2>Economia de Custos</h2>

  <h3>3.1 Composição de Custo</h3>
  <p>O custo operacional total é exclusivamente o Google AI Studio API. Todas as chamadas de inference via Antigravity (Claude Opus, Gemini Flash) são cobertas pela subscription flat — custo marginal zero por chamada.</p>

  <div class="card">
    <table>
      <thead><tr><th>Data</th><th>Sprint</th><th>Google (real)</th><th>Antigravity (nominal)</th><th>Custo Efetivo</th><th>Traces</th></tr></thead>
      <tbody>
        <tr><td><code>23/02</code></td><td rowspan="3">Sprint 2</td><td>$18.93</td><td>—</td><td>$18.93</td><td>—</td></tr>
        <tr><td><code>24/02</code></td><td>$23.74</td><td style="color:var(--tm)">$24.80</td><td>$23.74</td><td>~600</td></tr>
        <tr><td><code>25/02</code></td><td>$17.71</td><td style="color:var(--tm)">$171.45</td><td>$17.71</td><td>~1,200</td></tr>
        <tr style="background:var(--gb)"><td><code>26/02</code></td><td>Sprint 3</td><td>$4.22</td><td style="color:var(--tm)">$19.08</td><td style="color:var(--g);font-weight:700">$4.22</td><td>299</td></tr>
        <tr style="background:var(--s2)"><td colspan="2"><strong>Total</strong></td><td style="color:var(--y);font-weight:700">$64.60</td><td style="color:var(--tm)">$215.33</td><td style="color:var(--g);font-weight:700">$64.60</td><td>2,138</td></tr>
      </tbody>
    </table>
  </div>

  <h3>3.2 Unit Economics</h3>
  <div class="sg sg-4">
    <div class="sc"><div class="l">Custo / Trace</div><div class="n" style="color:var(--y)">$0.03</div><div class="d">$64.60 ÷ 2,138</div></div>
    <div class="sc"><div class="l">Custo / Edge Function</div><div class="n" style="color:var(--y)">$0.35</div><div class="d">$4.22 ÷ 12 (Sprint 3)</div></div>
    <div class="sc"><div class="l">Custo / Story Point</div><div class="n" style="color:var(--g)">$0.06</div><div class="d">$4.22 ÷ 76 SP</div></div>
    <div class="sc"><div class="l">Custo / Hora Humana</div><div class="n" style="color:var(--g)">$0.21</div><div class="d">$64.60 ÷ 310.7h</div></div>
  </div>

  <h3>3.3 Evolução do Custo por Minuto</h3>
  <div class="card">
    <div class="bar-wrap">
      <div class="bar-label"><span>Sprint 2</span><span style="color:var(--y)">$0.65 / min</span></div>
      <div class="bar"><div class="bar-fill" style="width:100%;background:linear-gradient(90deg,var(--ac),var(--p))">$0.65/min — Gemini Flash (pay-per-use)</div></div>
    </div>
    <div class="bar-wrap">
      <div class="bar-label"><span>Sprint 3</span><span style="color:var(--g)">$0.06 / min</span></div>
      <div class="bar"><div class="bar-fill" style="width:9.2%;background:var(--gg);min-width:180px">$0.06/min — Claude ($0 inference)</div></div>
    </div>
    <p style="margin-top:1rem;font-size:.8rem;text-align:center;color:var(--g);font-weight:600">↓ 90.8% de redução no custo por minuto de execução</p>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 4: ROI SCENARIOS -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 4</div>
  <h2>Cenários de ROI</h2>

  <p>O ROI varia com duas premissas: <span class="highlight">(1) quanto tempo um humano leva por 1K output tokens</span> e <span class="highlight">(2) quanto custa a hora desse humano</span>. Quatro cenários refletem faixas de mercado reais.</p>

  <div class="scen">
    <div class="scen-c">
      <div class="scen-l">Conservador</div>
      <div class="scen-n" style="color:var(--td)">5.573%</div>
      <div class="scen-d">6 min/1K tokens<br>$35/h — Júnior<br><br><span class="mono">155h equiv.</span><br><span class="mono">$5.425 valor</span></div>
    </div>
    <div class="scen-c act">
      <div class="scen-l" style="color:var(--ac2)">Base (atual)</div>
      <div class="scen-n" style="color:var(--g)">23.940%</div>
      <div class="scen-d">12 min/1K tokens<br>$50/h — Pleno<br><br><span class="mono" style="color:var(--g)">310.7h equiv.</span><br><span class="mono" style="color:var(--g)">$15.533 valor</span></div>
    </div>
    <div class="scen-c">
      <div class="scen-l">Otimista</div>
      <div class="scen-n" style="color:var(--y)">60.013%</div>
      <div class="scen-d">20 min/1K tokens<br>$75/h — Sênior<br><br><span class="mono">517.8h equiv.</span><br><span class="mono">$38.833 valor</span></div>
    </div>
    <div class="scen-c">
      <div class="scen-l">Enterprise</div>
      <div class="scen-n" style="color:var(--p)">180.340%</div>
      <div class="scen-d">30 min/1K tokens<br>$150/h — Consultor<br><br><span class="mono">776.7h equiv.</span><br><span class="mono">$116.500 valor</span></div>
    </div>
  </div>

  <div class="card" style="font-size:.78rem;color:var(--tm);font-family:'JetBrains Mono',monospace;padding:1rem;text-align:center">
    hoursEquiv = (outputTokens / 1000) × minPer1K / 60 &nbsp;·&nbsp; value = hoursEquiv × rate &nbsp;·&nbsp; ROI = (value − cost) / cost × 100<br>
    outputTokens ≈ 1.55M &nbsp;·&nbsp; cost = $64.60 (Google only)
  </div>

  <h3>4.1 Sensibilidade</h3>
  <p>Mesmo no cenário mais conservador (dev júnior, 6 min/1K tokens), o ROI é <span class="highlight">5.573%</span> — ou seja, cada $1 investido retorna $56.73 em valor. O sistema é rentável em qualquer cenário de mercado razoável.</p>

  <div class="callout green">
    <strong>Ponto de break-even:</strong> O sistema começa a gerar ROI positivo a partir de ~0.3 min/1K tokens e $1/h — premissas tão baixas que são praticamente impossíveis no mundo real. Em outras palavras: <strong>o sistema é sempre rentável.</strong>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 5: SPRINT 3 DEEP DIVE -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 5</div>
  <h2>Sprint 3 — Deep Dive Técnico</h2>

  <h3>5.1 Arquitetura Implementada</h3>
  <p>O motor de subscriptions segue o padrão Stripe-first: toda mutação de estado passa pelo Stripe API, e webhooks mantêm o banco local sincronizado. O banco local serve como cache para queries rápidas (dashboards, analytics), não como source of truth.</p>

  <div class="card">
    <table>
      <thead><tr><th>Tabela</th><th>Propósito</th><th>Campos-chave</th><th>RLS</th></tr></thead>
      <tbody>
        <tr><td><code>subscriptions</code></td><td>Estado local de assinaturas</td><td>stripe_subscription_id, status (8 estados), pause_collection, trial_start/end</td><td>✅</td></tr>
        <tr><td><code>subscription_items</code></td><td>Line items multi-price</td><td>stripe_item_id, stripe_price_id, quantity</td><td>✅</td></tr>
        <tr><td><code>subscription_events</code></td><td>Audit trail de eventos</td><td>stripe_event_id (idempotência), event_type, previous/new_status</td><td>✅</td></tr>
        <tr><td><code>checkout_sessions</code></td><td>Sessões de checkout</td><td>mode (payment/subscription/setup), status, amount_total, subscription_id FK</td><td>✅</td></tr>
      </tbody>
    </table>
  </div>

  <h3>5.2 Edge Functions — Detalhamento</h3>
  <div class="card">
    <table>
      <thead><tr><th>Function</th><th>Endpoints</th><th>Stripe APIs</th><th>KB</th><th>Complexidade</th></tr></thead>
      <tbody>
        <tr><td><strong>subscription-create</strong></td><td>POST /, POST /preview, GET /list, GET /:id</td><td>subscriptions.create, invoices.retrieveUpcoming</td><td>6.7</td><td><span class="tag tb">4 rotas</span></td></tr>
        <tr><td><strong>subscription-cancel</strong></td><td>POST /cancel, POST /reactivate, GET /status/:id</td><td>subscriptions.cancel, subscriptions.update</td><td>6.4</td><td><span class="tag tb">3 rotas</span></td></tr>
        <tr><td><strong>subscription-pause</strong></td><td>POST /pause, POST /resume, GET /status/:id</td><td>subscriptions.update (pause_collection)</td><td>6.7</td><td><span class="tag tb">3 rotas</span></td></tr>
        <tr><td><strong>subscription-update</strong></td><td>PUT /, GET /proration-preview, GET /history/:id</td><td>subscriptions.update, subscriptionItems.list, invoices.retrieveUpcoming</td><td>6.9</td><td><span class="tag ty">3 APIs</span></td></tr>
        <tr style="background:var(--yb)"><td><strong>stripe-webhooks-subscriptions</strong></td><td>POST / (webhook handler)</td><td>webhooks.constructEvent → 8 event types</td><td>10.3</td><td><span class="tag tr">13 SP — mais complexo</span></td></tr>
        <tr><td><strong>subscription-billing</strong></td><td>GET /upcoming-invoice, PUT /billing-cycle, GET /invoices, GET /usage</td><td>invoices.retrieveUpcoming, invoices.list, subscriptions.update</td><td>7.0</td><td><span class="tag tb">4 rotas</span></td></tr>
        <tr><td><strong>subscription-lifecycle</strong></td><td>POST /extend-trial, GET /trial-status, POST /convert-trial, GET /grace-period/:id</td><td>subscriptions.update (trial_end)</td><td>7.4</td><td><span class="tag tb">4 rotas</span></td></tr>
        <tr><td><strong>subscriptions-dashboard</strong></td><td>GET /overview, /list, /analytics, /export</td><td>— (DB only)</td><td>7.5</td><td><span class="tag tg">read-only</span></td></tr>
        <tr><td><strong>checkout-sessions</strong></td><td>POST /, GET /list, GET /:id, POST /recover</td><td>checkout.sessions.create</td><td>7.9</td><td><span class="tag ty">hosted + embedded</span></td></tr>
        <tr><td><strong>stripe-webhooks-checkout</strong></td><td>POST / (webhook handler)</td><td>webhooks.constructEventAsync → 4 events</td><td>5.2</td><td><span class="tag tb">4 events</span></td></tr>
        <tr><td><strong>checkout-expire</strong></td><td>POST /expire, POST /cleanup, GET /abandoned</td><td>checkout.sessions.expire</td><td>5.1</td><td><span class="tag tg">3 rotas</span></td></tr>
        <tr><td><strong>checkout-analytics</strong></td><td>GET /conversion, /abandonment, /revenue, /overview</td><td>— (DB only)</td><td>7.1</td><td><span class="tag tg">read-only</span></td></tr>
      </tbody>
    </table>
    <div style="margin-top:1rem;display:flex;gap:2rem;justify-content:center;font-size:.78rem;color:var(--td)">
      <span>Total: <strong style="color:var(--t)">12 functions</strong></span>
      <span>~<strong style="color:var(--t)">32 endpoints</strong></span>
      <span><strong style="color:var(--t)">82.3 KB</strong> de código</span>
      <span>Média: <strong style="color:var(--t)">6.9 KB</strong>/function</span>
    </div>
  </div>

  <h3>5.3 Pipeline de Execução (BMAD-CE)</h3>
  <div class="card">
    <div class="tl">
      <div class="tl-i"><div class="tl-t">00:00 — Stage 1: Context Scout</div><div class="tl-x">Análise de Confluence specs (EPIC-03: 11KB, EPIC-06: 10KB), repo audit, existing code, dependency mapping</div><div class="tl-d">Identificou: 4 páginas de frontend já existentes (316KB), Edge Functions como stubs (141B), nenhuma tabela de subscriptions</div></div>
      <div class="tl-i"><div class="tl-t">00:05 — Stage 4: Architecture</div><div class="tl-x">Schema de 4 tabelas, 10 indexes, RLS, mapeamento de 32 endpoints, planejamento de 5 batches</div><div class="tl-d">Decisão: Stripe-first pattern, webhook-driven state sync, batch size 3-4 funções por subagente</div></div>
      <div class="tl-i"><div class="tl-t">00:10 — Batch 1: Foundation</div><div class="tl-x">Migration SQL + subscription-create + subscription-cancel</div><div class="tl-d">Subagente criou 3 arquivos, pushed to main, CI triggered</div></div>
      <div class="tl-i"><div class="tl-t">00:18 — Batch 2: Lifecycle</div><div class="tl-x">subscription-pause + subscription-update + stripe-webhooks-subscriptions</div><div class="tl-d">Webhook handler = função mais complexa (10.3KB, 8 event types, idempotência)</div></div>
      <div class="tl-i"><div class="tl-t">00:26 — Batch 3: Support</div><div class="tl-x">subscription-billing + subscription-lifecycle + subscriptions-dashboard</div><div class="tl-d">Dashboard = read-only (sem Stripe API calls), analytics com growth/churn calculation</div></div>
      <div class="tl-i"><div class="tl-t">00:34 — Batch 4: EPIC-06</div><div class="tl-x">checkout-sessions + stripe-webhooks-checkout + checkout-expire + checkout-analytics</div><div class="tl-d">Over-delivery: embedded checkout + cart recovery (spec dizia "fora do escopo")</div></div>
      <div class="tl-i"><div class="tl-t">00:42 — Batch 5: QA (Stage 13)</div><div class="tl-x">6 test suites, ~60 test cases (Vitest)</div><div class="tl-d">Mocks para Stripe + Supabase, cobertura de success + error cases</div></div>
      <div class="tl-i"><div class="tl-t">00:50 — Gap Analysis (Stage 15)</div><div class="tl-x">Validação contra Confluence specs: 47/63 requisitos atendidos, 0 gaps bloqueantes</div><div class="tl-d">7 gaps não-bloqueantes documentados para sprints futuras (reconciliation job, E2E tests, alerting)</div></div>
      <div class="tl-i"><div class="tl-t">01:05 — Sprint Fechada</div><div class="tl-x" style="color:var(--g);font-weight:700">15/15 tickets → CONCLUÍDO. Jira retroalimentado. Slack notificado.</div></div>
    </div>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 6: SPRINT 2 DEEP DIVE -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 6</div>
  <h2>Sprint 2 — Root Cause Analysis</h2>

  <h3>6.1 Estado Inicial: O Que Estava Quebrado</h3>
  <p>Sprint 2 foi entregue em código mas sem quality gates. O CI/CD estava 100% quebrado há 3 dias sem detecção, 18/22 tickets Jira não tinham descrição, e a cobertura de documentação era 14%.</p>

  <div class="sg sg-3">
    <div class="sc"><div class="l">CI/CD</div><div class="n" style="color:var(--r)">0%</div><div class="d">3 workflows falhando</div></div>
    <div class="sc"><div class="l">Jira Descriptions</div><div class="n" style="color:var(--r)">18%</div><div class="d">4/22 preenchidos</div></div>
    <div class="sc"><div class="l">Confluence</div><div class="n" style="color:var(--r)">14%</div><div class="d">3/22 USs documentadas</div></div>
  </div>

  <h3>6.2 Root Causes do CI/CD</h3>
  <div class="card">
    <table>
      <thead><tr><th>#</th><th>Root Cause</th><th>Impacto</th><th>Fix</th></tr></thead>
      <tbody>
        <tr><td>1</td><td><code>vitest: ^4.0.18</code> — versão inexistente (dependabot bump)</td><td>npm install falha</td><td>Pinned para <code>^3.2.1</code></td></tr>
        <tr><td>2</td><td><code>@eslint/js: ^10.0.1</code> conflita com <code>eslint: ^9.x</code></td><td>Lint falha</td><td>Pinned para <code>^9.32.0</code></td></tr>
        <tr><td>3</td><td><code>NODE_ENV=production</code> no ci.yml</td><td>npm ci skipa devDeps silenciosamente</td><td>Mudado para <code>development</code></td></tr>
        <tr><td>4</td><td>npm cache stale no GitHub Actions</td><td>Cache com deps errados</td><td><code>npm cache clean --force</code></td></tr>
        <tr><td>5</td><td>Node 20 nos workflows, projeto em Node 22</td><td>Incompatibilidade de runtime</td><td>Alinhado para Node 22</td></tr>
      </tbody>
    </table>
  </div>

  <h3>6.3 Resultado da Remediação</h3>
  <div class="card">
    <table>
      <thead><tr><th>Área</th><th>Antes</th><th>Depois</th><th>Método</th></tr></thead>
      <tbody>
        <tr><td>CI/CD</td><td><span class="tag tr">0%</span></td><td><span class="tag tg">100%</span></td><td>5 root causes corrigidos, 3 workflows green</td></tr>
        <tr><td>Test Coverage</td><td><span class="tag ty">52%</span></td><td><span class="tag tg">95%</span></td><td>10 suítes criadas (split, products, webhook handlers)</td></tr>
        <tr><td>Jira Docs</td><td><span class="tag tr">18%</span></td><td><span class="tag tg">100%</span></td><td>18 tickets retroalimentados com descrição + AC + links</td></tr>
        <tr><td>PRs Linkados</td><td><span class="tag tr">0%</span></td><td><span class="tag tg">100%</span></td><td>20 PRs mapeados e comentados nos tickets</td></tr>
        <tr><td>Confluence</td><td><span class="tag tr">14%</span></td><td><span class="tag tg">100%</span></td><td>4 EPICs documentados (EPIC-02, 05, 07, 10)</td></tr>
        <tr><td>Assignees</td><td><span class="tag tr">0%</span></td><td><span class="tag tg">100%</span></td><td>22 tickets atribuídos</td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 7: QUALITY -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 7</div>
  <h2>Análise de Qualidade</h2>

  <h3>7.1 Gap Analysis: Spec vs Implementação</h3>
  <p>Cada implementação foi validada contra a especificação técnica do Confluence. Os resultados:</p>
  <div class="sg sg-3">
    <div class="sc"><div class="l">EPIC-03 Compliance</div><div class="n" style="color:var(--g)">79%</div><div class="d">26/33 requisitos atendidos</div></div>
    <div class="sc"><div class="l">EPIC-06 Compliance</div><div class="n" style="color:var(--g)">70%</div><div class="d">21/30 requisitos atendidos</div></div>
    <div class="sc"><div class="l">Gaps Bloqueantes</div><div class="n" style="color:var(--g)">0</div><div class="d">Zero bloqueantes</div></div>
  </div>

  <h3>7.2 Gaps Identificados (não-bloqueantes)</h3>
  <div class="card">
    <table>
      <thead><tr><th>Gap</th><th>Spec</th><th>Realidade</th><th>Quando Resolver</th></tr></thead>
      <tbody>
        <tr><td>Reconciliation job</td><td>Job diário Stripe↔DB</td><td>Não implementado</td><td>Sprint 4+</td></tr>
        <tr><td>E2E tests</td><td>Ciclo completo simulado</td><td>Unit tests apenas</td><td>Sprint 4+</td></tr>
        <tr><td>Structured metrics</td><td>Prometheus/Grafana</td><td>console.log</td><td>EPIC-23 (DevOps)</td></tr>
        <tr><td>Alerting</td><td>Webhook falha 3×, checkout expiration &gt;20%</td><td>Sem alertas</td><td>EPIC-23</td></tr>
        <tr><td>stripe-mock tests</td><td>Integração com stripe-mock</td><td>vi.fn() mocks</td><td>Sprint 4+</td></tr>
        <tr><td>CSRF tokens</td><td>Anti-CSRF no checkout</td><td>JWT auth (parcial)</td><td>Sprint 4+</td></tr>
        <tr><td>Email recovery</td><td>Lembrete 24h carrinho</td><td>Recovery URL sem email worker</td><td>EPIC-25 (Email)</td></tr>
      </tbody>
    </table>
  </div>

  <h3>7.3 Over-Deliveries</h3>
  <p>Funcionalidades entregues além do que a especificação solicitava:</p>
  <div class="card">
    <table>
      <tbody>
        <tr><td style="width:35%"><strong>Embedded Checkout</strong></td><td>Spec dizia "Fora do Escopo". Implementamos <code>ui_mode=embedded</code> com <code>client_secret</code> return</td></tr>
        <tr><td><strong>Cart Recovery</strong></td><td>Spec dizia "Fora do Escopo". Implementamos POST /recover + GET /abandoned com abandonment rate</td></tr>
        <tr><td><strong>Trial Lifecycle</strong></td><td>Spec mencionava trial superficialmente. Implementamos extend, convert, grace period, days_remaining</td></tr>
        <tr><td><strong>CSV Export</strong></td><td>Não especificado. Implementamos GET /export com format=json|csv</td></tr>
        <tr><td><strong>Billing History</strong></td><td>Não especificado. Implementamos GET /invoices com paginação e hosted_invoice_url</td></tr>
      </tbody>
    </table>
  </div>

  <h3>7.4 Divergência Arquitetural (aceita)</h3>
  <div class="callout yellow">
    <strong>Nota:</strong> Os specs Confluence foram escritos assumindo Python/FastAPI/SQLAlchemy. O projeto usa Deno/Supabase Edge Functions/PostgREST. Esta divergência é estrutural e aceita — os conceitos de negócio (endpoints, status, fluxos) foram preservados fielmente.
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 8: AGENT PERFORMANCE -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 8</div>
  <h2>Performance dos Agentes</h2>

  <h3>8.1 Distribuição de Traces</h3>
  <div class="card">
    <table>
      <thead><tr><th>Agente</th><th>Sprint 2</th><th>Sprint 3</th><th>Total</th><th>Share</th></tr></thead>
      <tbody>
        <tr><td><strong>OraCLI</strong> (orchestrator)</td><td>1,488</td><td>83</td><td>1,571</td><td>73.5%</td></tr>
        <tr><td><strong>General Agent</strong></td><td>211</td><td>102</td><td>313</td><td>14.6%</td></tr>
        <tr><td><strong>Docs Agent</strong></td><td>84</td><td>—</td><td>84</td><td>3.9%</td></tr>
        <tr><td><strong>Code Agent</strong></td><td>30</td><td>—</td><td>30</td><td>1.4%</td></tr>
        <tr><td><strong>Infra Agent</strong></td><td>2</td><td>—</td><td>2</td><td>0.1%</td></tr>
        <tr style="background:var(--s2)"><td><strong>Total</strong></td><td>1,815</td><td>185</td><td><strong>2,138</strong></td><td>100%</td></tr>
      </tbody>
    </table>
  </div>

  <h3>8.2 Eficiência por Sprint</h3>
  <div class="sg sg-2">
    <div class="sc"><div class="l">Sprint 2: Traces/min</div><div class="n" style="color:var(--b)">19.5</div><div class="d">1,815 traces / 93 min</div></div>
    <div class="sc"><div class="l">Sprint 3: Traces/min</div><div class="n" style="color:var(--g)">2.8</div><div class="d">185 traces / 65 min</div></div>
  </div>
  <p>Sprint 3 usou <span class="highlight">86% menos traces</span> para produzir <span class="highlight">72% mais valor</span>. Isso indica que o modelo Claude Opus (Sprint 3) é significativamente mais eficiente por chamada que o Gemini Flash (Sprint 2) — produz mais output por trace, resultando em menos round-trips.</p>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 9: RISKS & LESSONS -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 9</div>
  <h2>Riscos e Lições</h2>

  <h3>9.1 Riscos Identificados</h3>
  <div class="card">
    <table>
      <thead><tr><th>Risco</th><th>Probabilidade</th><th>Impacto</th><th>Mitigação</th></tr></thead>
      <tbody>
        <tr><td>Push direto na main sem PR</td><td><span class="tag ty">Médio</span></td><td>Sem code review formal</td><td>Implementar branch strategy + PR obrigatório</td></tr>
        <tr><td>Dependência do Antigravity</td><td><span class="tag ty">Médio</span></td><td>Vendor lock-in</td><td>Fallback chain: Gemini Pro → Flash configurado</td></tr>
        <tr><td>Stubs de 141B nos Edge Functions</td><td><span class="tag tr">Alto</span></td><td>Funções antigas podem não ter sido sobrescritas</td><td>Verificar SHA do commit vs conteúdo</td></tr>
        <tr><td>Migration não aplicada em produção</td><td><span class="tag ty">Médio</span></td><td>Edge Functions sem tabelas</td><td>Staging workflow aplica; prod precisa manual</td></tr>
      </tbody>
    </table>
  </div>

  <h3>9.2 Lições Consolidadas</h3>
  <div class="card">
    <table>
      <tbody>
        <tr><td style="width:3%;color:var(--tm)">1</td><td><strong>Antigravity é game-changer</strong> — custo/min caiu 90.8%, output/min subiu 145%. A decisão de migrar para subscription flat foi o maior multiplicador de ROI.</td><td style="width:15%"><span class="tag tg">↓93% custo</span></td></tr>
        <tr><td style="color:var(--tm)">2</td><td><strong>Batch pattern de 3-4 itens é o sweet spot</strong> — batches maiores perdem contexto, menores perdem eficiência. O subagente mantém qualidade consistente com 3-4 funções por sessão.</td><td><span class="tag tg">12 func/65min</span></td></tr>
        <tr><td style="color:var(--tm)">3</td><td><strong>Dependabot sem CI guard é bomba-relógio</strong> — bumps automáticos quebraram 3 dependências sem detecção por 3 dias. CI deve ser pré-requisito para merge de dependabot.</td><td><span class="tag tr">CI down 3d</span></td></tr>
        <tr><td style="color:var(--tm)">4</td><td><strong>Gap analysis antes de fechar sprint é quality gate essencial</strong> — validar contra specs do Confluence evita acumular dívida técnica invisível.</td><td><span class="tag tg">7 gaps caught</span></td></tr>
        <tr><td style="color:var(--tm)">5</td><td><strong>Over-delivery controlada agrega valor real</strong> — embedded checkout e cart recovery não estavam no spec, mas são features de alto impacto que custaram ~$0.50 extra.</td><td><span class="tag ty">Bonus features</span></td></tr>
        <tr><td style="color:var(--tm)">6</td><td><strong>Tickets criados em bulk sem descrição são dívida imediata</strong> — 18/22 tickets vazios geraram 4h de retroalimentação. Investir 5min na criação economiza 30min depois.</td><td><span class="tag ty">4h retrabalho</span></td></tr>
        <tr><td style="color:var(--tm)">7</td><td><strong>Claude Opus produz mais output por trace que Gemini Flash</strong> — 86% menos traces para 72% mais valor sugere que o modelo mais capaz é mais eficiente em cenário de subscription flat.</td><td><span class="tag tg">Eficiência ↑</span></td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 10: PROJECTIONS -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 10</div>
  <h2>Projeções: Sprint 4 e Fechamento do Q1</h2>

  <h3>10.1 Escopo Restante</h3>
  <p>Dois EPICs restam para fechar o Q1 Core Financeiro:</p>
  <div class="sg sg-2">
    <div class="sc"><div class="l">EPIC-04: Invoicing Engine</div><div class="n" style="color:var(--y)">40 SP</div><div class="d">Faturas, credit notes, billing runs</div></div>
    <div class="sc"><div class="l">EPIC-09: Core Metrics</div><div class="n" style="color:var(--y)">~30 SP</div><div class="d">MRR, ARR, churn rate, LTV</div></div>
  </div>

  <h3>10.2 Projeção Baseada em Sprint 3</h3>
  <p>Usando Sprint 3 como baseline (a mais recente e representativa):</p>
  <div class="card">
    <table>
      <thead><tr><th>Métrica</th><th>Sprint 3 (real)</th><th>Sprint 4 (projeção)</th></tr></thead>
      <tbody>
        <tr><td>Story Points</td><td>76 SP</td><td>~70 SP</td></tr>
        <tr><td>Edge Functions</td><td>12</td><td>~10-12</td></tr>
        <tr><td>Execução AI</td><td>65 min</td><td>~60-70 min</td></tr>
        <tr><td>Custo Google</td><td>$4.22</td><td>~$4-5</td></tr>
        <tr><td>Humano equiv.</td><td>196.3h</td><td>~170-200h</td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout green">
    <strong>Projeção Q1 Total:</strong> Com Sprint 4 estimada em ~$5 e ~65 min, o Q1 inteiro (Sprints 2-4) terá custado <strong>~$70</strong> em 3.7 horas de AI, produzindo <strong>~480 horas</strong> de trabalho humano equivalente — fechando 9/9 EPICs do Core Financeiro.
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- CHAPTER 11: PLATFORM STACK — OPENCLAW + AIOS -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Capítulo 11</div>
  <h2>Stack de Plataforma: OpenClaw + AIOS</h2>

  <p>O sistema opera sobre duas plataformas complementares. <span class="highlight">OpenClaw</span> é o runtime de agentes — gerencia sessões, subagentes, ferramentas, canais. <span class="highlight">AIOS</span> (Agent Intelligence Operating System) é a camada de telemetria e observabilidade — captura traces, custos, métricas e alimenta o dashboard em tempo real.</p>

  <h3>11.1 OpenClaw — Runtime de Agentes</h3>
  <p>OpenClaw é o gateway que conecta modelos de IA a ferramentas do mundo real. Cada ação executada neste relatório passou pelo OpenClaw Gateway rodando no EC2.</p>

  <div class="card">
    <table>
      <thead><tr><th>Onde foi usado</th><th>Capability OpenClaw</th><th>Sprint</th><th>Detalhes</th></tr></thead>
      <tbody>
        <tr><td><strong>Spawning de Subagentes</strong></td><td><code>sessions_spawn</code></td><td>2 + 3</td><td>5 batches de subagentes na Sprint 3, 6 subagentes paralelos na Sprint 2 (code-audit, infra-health, jira-retroalimentação)</td></tr>
        <tr><td><strong>Execução de ferramentas</strong></td><td><code>exec</code></td><td>2 + 3</td><td>Shell commands, scripts Python, github-api, jira-api, confluence-api — todos roteados pelo gateway</td></tr>
        <tr><td><strong>Comunicação Telegram</strong></td><td>Channel routing</td><td>2 + 3</td><td>Toda interação com João via Telegram passa pelo OpenClaw como bridge bidirecional</td></tr>
        <tr><td><strong>Heartbeat system</strong></td><td>Heartbeat polls</td><td>2 + 3</td><td>Checks periódicos: gateway status, streamer health, ROI calculator sync — via HEARTBEAT.md</td></tr>
        <tr><td><strong>Model routing</strong></td><td>Provider config</td><td>2 + 3</td><td>Fallback chain configurada: Gemini 3 Flash → Gemini 2.5 Pro → Gemini 2.5 Flash. Antigravity como provider OAuth</td></tr>
        <tr><td><strong>Subagent model config</strong></td><td><code>openclaw.json</code></td><td>3</td><td>Subagentes padronizados em <code>google-antigravity/gemini-3-flash</code> — decisão após incompatibilidade Sonnet/thinking.signature</td></tr>
        <tr><td><strong>Slack notifications</strong></td><td><code>composio-exec</code> via gateway</td><td>2 + 3</td><td>Sprint kickoff + completion posts em #sprint-current e #announcements</td></tr>
        <tr><td><strong>Jira lifecycle</strong></td><td><code>jira-api</code> skill</td><td>2 + 3</td><td>Create sprints, transition tickets (31→41→51), retroalimentar 35 tickets, assign 22 tickets</td></tr>
        <tr><td><strong>Confluence docs</strong></td><td><code>confluence-api</code> skill</td><td>2</td><td>6 páginas criadas/atualizadas (3 análises + 3 EPICs merged com templates existentes)</td></tr>
        <tr><td><strong>GitHub pushes</strong></td><td><code>github-api</code> skill</td><td>2 + 3</td><td>12 Edge Functions, 6 test suites, 1 migration, CI fixes — tudo via <code>github-api file push</code></td></tr>
        <tr><td><strong>Memory persistence</strong></td><td>Workspace files</td><td>2 + 3</td><td>MEMORY.md, memory/2026-02-*.md, HEARTBEAT.md — continuidade entre sessões</td></tr>
        <tr><td><strong>Web search + fetch</strong></td><td><code>web_search</code>, <code>web_fetch</code></td><td>2</td><td>Research de dependências (vitest versioning, eslint compatibility)</td></tr>
        <tr><td><strong>Sprint close</strong></td><td><code>composio-exec</code> proxy</td><td>2</td><td>POST direto ao Jira REST API via Composio proxy (sprint.close não suportado nativamente)</td></tr>
      </tbody>
    </table>
  </div>

  <div class="callout">
    <strong>Infraestrutura OpenClaw:</strong> Gateway rodando como container Docker (<code>openclaw-gateway</code>) no EC2 <code>sa-east-1</code> (IP: 18.229.126.186). Config em <code>~/.openclaw/openclaw.json</code> — 5 providers configurados, subagent limits: maxConcurrent=8, maxSpawnDepth=2.
  </div>

  <h3>11.2 AIOS — Telemetria e Observabilidade</h3>
  <p>AIOS captura cada trace de execução, calcula custos em tempo real, e alimenta o dashboard de orquestração. Sem AIOS, não teríamos os dados para produzir este relatório.</p>

  <div class="card">
    <table>
      <thead><tr><th>Onde foi usado</th><th>Componente AIOS</th><th>Sprint</th><th>Detalhes</th></tr></thead>
      <tbody>
        <tr><td><strong>Streaming de traces</strong></td><td><code>aios_gateway_streamer.py</code></td><td>2 + 3</td><td>Watcher de sessões JSONL do OpenClaw → insere traces na tabela <code>traces</code> do Supabase em tempo real. PID 18319 monitorado via heartbeat</td></tr>
        <tr><td><strong>Multi-agent attribution</strong></td><td><code>detect_agent_id()</code></td><td>2 + 3</td><td>Função no streamer que identifica subagentes pelo marker <code>[Subagent Context]</code> nos arquivos JSONL — atribui cada trace ao agente correto (code/docs/general/infra/oracli)</td></tr>
        <tr><td><strong>Custo em tempo real</strong></td><td><code>daily_costs</code> table</td><td>2 + 3</td><td>821 rows, 4 dates. Streamer calcula custo por provider (Google vs Antigravity) e insere automaticamente</td></tr>
        <tr><td><strong>Dashboard de agentes</strong></td><td><code>agent-orchestrator</code></td><td>2 + 3</td><td>React app em Vercel lê tabelas AIOS (traces, tasks, agents, daily_costs, missions) via Supabase realtime subscriptions</td></tr>
        <tr><td><strong>ROI em tempo real</strong></td><td><code>useRealTimeROI()</code></td><td>2 + 3</td><td>Hook React — calcula ROI direto dos traces, não do campo agents.roi. Single source of truth para todas as páginas do dashboard</td></tr>
        <tr><td><strong>ROI backend sync</strong></td><td><code>scripts/roi-calculator.py</code></td><td>2 + 3</td><td>Roda no heartbeat, calcula ROI agregado e faz PATCH em agents.roi no Supabase. Backup do hook frontend</td></tr>
        <tr><td><strong>Task tracking</strong></td><td><code>tasks</code> table</td><td>2 + 3</td><td>356 tasks registradas, 316 done. Distribuição: Code Agent (253), OraCLI (47), Infra (9), General (7)</td></tr>
        <tr><td><strong>OTel integration</strong></td><td><code>diagnostics-otel</code></td><td>2</td><td>OpenTelemetry ativado no gateway — emissão de traces, metrics e logs via OTLP HTTP para backend no EC2</td></tr>
        <tr><td><strong>Realtime subscriptions</strong></td><td>Supabase Realtime</td><td>2 + 3</td><td>Dashboard assina changes em 6 tabelas (traces, tasks, agents, daily_costs, missions, deliverables) — UI atualiza sem refresh</td></tr>
        <tr><td><strong>pgvector memory</strong></td><td><code>openclaw_memory</code> DB</td><td>2</td><td>12 memories embedadas (768d vectors), 11 graph nodes. Usado no Stage 1 (Context Scout) do BMAD-CE</td></tr>
        <tr><td><strong>Este relatório</strong></td><td>Queries AIOS</td><td>—</td><td>Todos os dados deste report foram obtidos via queries diretas às tabelas AIOS no Supabase (traces, daily_costs, tasks, agents)</td></tr>
      </tbody>
    </table>
  </div>

  <h3>11.3 Fluxo Integrado: OpenClaw ↔ AIOS</h3>
  <div class="card">
    <div class="tl">
      <div class="tl-i"><div class="tl-t">1. Trigger</div><div class="tl-x">João envia mensagem no <strong>Telegram</strong> → OpenClaw Channel Bridge recebe</div></div>
      <div class="tl-i"><div class="tl-t">2. Orchestration</div><div class="tl-x"><strong>OpenClaw Gateway</strong> roteia para OraCLI (Claude Opus via Antigravity) → OraCLI decide a ação</div></div>
      <div class="tl-i"><div class="tl-t">3. Subagent Spawn</div><div class="tl-x">OraCLI usa <strong>sessions_spawn</strong> do OpenClaw → Gateway cria sessão isolada com Gemini Flash</div></div>
      <div class="tl-i"><div class="tl-t">4. Tool Execution</div><div class="tl-x">Subagente usa <strong>exec/github-api/jira-api</strong> via OpenClaw → código pushado, tickets atualizados</div></div>
      <div class="tl-i"><div class="tl-t">5. Trace Capture</div><div class="tl-x"><strong>AIOS Streamer</strong> detecta JSONL do gateway → extrai agent_id, calcula custo, insere em Supabase</div></div>
      <div class="tl-i"><div class="tl-t">6. Dashboard Update</div><div class="tl-x"><strong>Supabase Realtime</strong> notifica o dashboard → <strong>useRealTimeROI()</strong> recalcula ROI instantaneamente</div></div>
      <div class="tl-i"><div class="tl-t">7. Heartbeat</div><div class="tl-x"><strong>OpenClaw Heartbeat</strong> roda roi-calculator.py → AIOS atualiza agents.roi como backup sync</div></div>
    </div>
  </div>

  <h3>11.4 Números de Plataforma</h3>
  <div class="sg sg-4">
    <div class="sc"><div class="l">Traces AIOS</div><div class="n" style="color:var(--cy)">2,138</div><div class="d">100% success rate</div></div>
    <div class="sc"><div class="l">Subagent Sessions</div><div class="n" style="color:var(--cy)">~20</div><div class="d">Spawned via OpenClaw</div></div>
    <div class="sc"><div class="l">Tool Calls</div><div class="n" style="color:var(--cy)">~3,500</div><div class="d">exec, github-api, jira-api, etc.</div></div>
    <div class="sc"><div class="l">Daily Cost Rows</div><div class="n" style="color:var(--cy)">821</div><div class="d">Streamer → Supabase</div></div>
  </div>
</div>

<!-- ═══════════════════════════════════════════ -->
<!-- METHODOLOGY -->
<!-- ═══════════════════════════════════════════ -->
<div class="chapter">
  <div class="chapter-num">Metodologia</div>
  <h2>BMAD-CE (Business-Mission-Architecture-Development — Cognitive Engineering)</h2>

  <p>Pipeline de 18 estágios adaptado por complexidade. Cada tarefa Jira passa pelo subconjunto relevante dos estágios, com artefatos documentados em cada passo.</p>

  <div class="card">
    <table>
      <thead><tr><th>Stage</th><th>Owner</th><th>Artefato</th><th>Sprint 2</th><th>Sprint 3</th></tr></thead>
      <tbody>
        <tr><td>1. Context Scout</td><td>OraCLI</td><td>Memory + Confluence + repo search</td><td>✅</td><td>✅</td></tr>
        <tr><td>4. Architecture</td><td>OraCLI</td><td>Schema, API design, batch plan</td><td>—</td><td>✅</td></tr>
        <tr><td>10. Specifier</td><td>Code Agent</td><td>Technical spec per function</td><td>✅</td><td>✅</td></tr>
        <tr><td>11. Developer</td><td>Code Agent</td><td>Implementation</td><td>✅</td><td>✅</td></tr>
        <tr><td>12. Code Review</td><td>OraCLI</td><td>Jira transitions</td><td>✅</td><td>✅</td></tr>
        <tr><td>13. QA Tester</td><td>Code Agent</td><td>Test suites</td><td>✅</td><td>✅</td></tr>
        <tr><td>15. Stakeholder</td><td>OraCLI</td><td>Gap analysis, reports</td><td>✅</td><td>✅</td></tr>
        <tr><td>17. Knowledge</td><td>OraCLI</td><td>Jira comments, memory updates</td><td>✅</td><td>✅</td></tr>
      </tbody>
    </table>
  </div>

  <h3>Fórmulas de ROI</h3>
  <div class="card" style="font-family:'JetBrains Mono',monospace;font-size:.8rem;color:var(--td)">
    <p><strong style="color:var(--t)">Human Hour Equivalent:</strong> <code>hoursEquiv = (totalOutputTokens / 1000) × MINUTES_PER_1K_TOKENS / 60</code></p>
    <p style="margin-top:.5rem"><strong style="color:var(--t)">Value Generated:</strong> <code>value = hoursEquiv × HOURLY_RATE</code></p>
    <p style="margin-top:.5rem"><strong style="color:var(--t)">ROI:</strong> <code>roi = (value − operationalCost) / operationalCost × 100</code></p>
    <p style="margin-top:.5rem"><strong style="color:var(--t)">Speedup:</strong> <code>speedup = humanMinutes / aiMinutes</code></p>
    <p style="margin-top:1rem;color:var(--tm)">Base parameters: MINUTES_PER_1K_TOKENS = 12 · HOURLY_RATE = $50 · operationalCost = Google API only ($64.60)</p>
    <p style="color:var(--tm)">Output tokens estimated from Antigravity nominal cost: ~$0.015/1K tokens → ~1.55M total tokens</p>
  </div>
</div>

</div>

<div class="footer">
  <p><strong>OraCLI</strong> — Multi-Agent AI System for Software Engineering</p>
  <p style="margin-top:.3rem">Claude Opus 4.6 (Antigravity) · Gemini 3 Flash · OpenClaw Gateway</p>
  <p style="margin-top:1rem">
    <a href="https://agent-orchestrator-nu.vercel.app">Dashboard</a> ·
    <a href="https://vivaldi-revopos.atlassian.net/jira/software/projects/SCRUM/boards/1">Jira</a> ·
    <a href="https://vivaldi-revopos.atlassian.net/wiki/spaces/VR">Confluence</a> ·
    <a href="https://github.com/juboyy/revenue-OS">GitHub</a>
  </p>
  <p style="margin-top:.5rem">26 de Fevereiro de 2026 · v3.0 Deep Analysis</p>
</div>

</body>
</html>
